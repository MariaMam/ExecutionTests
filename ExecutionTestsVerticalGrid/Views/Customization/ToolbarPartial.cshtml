@using DevExpress.Data.Linq;
@using DevExpress.Data.Filtering;

@Html.DevExpress().VerticalGrid(settings => {
    settings.Name = "VerticalGrid";
    settings.CallbackRouteValues = new { Action = "ToolbarPartial", Controller = "Customization" };
    settings.Width = Unit.Percentage(100);

    settings.Toolbars.Add(t => {
        t.Items.Add(i => {
            i.GroupName = "View";
            i.Name = "All";
            i.Text = "Display all";
            i.Checked = ViewBag.IsAllView;
        });
        t.Items.Add(i => {
            i.GroupName = "View";
            i.Name = "Distinct";
            i.Text = "Display differences";
            i.Checked = !ViewBag.IsAllView;
        });
        t.Items.Add(VerticalGridToolbarCommand.ShowFilterEditor, true);
        t.Items.Add(VerticalGridToolbarCommand.ShowSearchPanel, true);
    });

    settings.Rows.Add(r => {
        r.FieldName = "PhotoUrl";
        r.Caption = "Photo";
        r.EditorProperties().Image(p => p.ImageHeight = 180);
    });
    settings.Rows.Add("Model").RecordStyle.HorizontalAlign = HorizontalAlign.Center;
    settings.Rows.Add("Power", "Power, MW").RecordStyle.HorizontalAlign = HorizontalAlign.Center;
    settings.Rows.Add("Impedance", "Impendance, ohms").RecordStyle.HorizontalAlign = HorizontalAlign.Center;
    settings.Rows.Add("Wireless", MVCxVerticalGridRowType.CheckBox);
    settings.Rows.Add("Bluetooth", MVCxVerticalGridRowType.CheckBox);
    settings.Rows.Add("SoundIsolating", MVCxVerticalGridRowType.CheckBox);
    settings.Rows.Add("WaterResistant", MVCxVerticalGridRowType.CheckBox);
    settings.Rows.Add("PhoneControl", MVCxVerticalGridRowType.CheckBox);
    settings.Rows.Add("CarryingCase", MVCxVerticalGridRowType.CheckBox);
    settings.Rows.Add("BuiltInMicrophone", MVCxVerticalGridRowType.CheckBox);

    settings.ClientSideEvents.ToolbarItemClick = "OnToolbarItemClick";
    settings.ClientSideEvents.BeginCallback = "OnBeginCallback";

    settings.BeforeGetCallbackResult = (s, e) => {
        var grid = (MVCxVerticalGrid)s;
        foreach(var row in grid.DataRows) {
           row.Visible = ViewBag.IsAllView ? true : HeadphoneCompareData.HasRowDifferentValues(row.FieldName);
        }
    };
}).Bind(Model).GetHtml()